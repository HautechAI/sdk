#!/bin/bash

# Core API base URL (arg1) and Directory API base URL (arg2)
API_CORE_URL=${1:-"https://api.hautech.ai"}
API_DIRECTORY_URL=${2:-"https://api-directory.hautech.ai"}

# Export for orval.config.ts to pick up
export API_CORE_URL
export API_DIRECTORY_URL

# Generate API clients for Core and Directory (configured in orval.config.ts)
pnpm orval

# Permissions are sourced from Core API only
node ./scripts/generate-permissions.js $API_CORE_URL/v1/permissions/available ./src/autogenerated/permissions.ts

# Generate pipeline helper methods based on Core API client
node ./scripts/generate-pipeline-methods.js ./src/autogenerated/pipeline-methods.ts
